<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quaternion Attractor Visualization</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .control-group {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .control-group h3 {
            margin-top: 0;
            color: #ffd700;
        }
        
        .input-group {
            margin-bottom: 10px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        
        input[type="range"] {
            width: 100%;
        }
        
        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .randomize-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }
        
        .clear-btn {
            background: linear-gradient(45deg, #ffa726, #ff9800);
        }
        
        .canvas-container {
            text-align: center;
            margin-top: 20px;
        }
        
        canvas {
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
        }
        
        .info {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Quaternion Attractor Visualization</h1>
        
        <div class="controls">
            <div class="control-group">
                <h3>Initial Position (x, y, z, side)</h3>
                <div class="input-group">
                    <label for="initX">X: <span id="initXValue">0.0</span></label>
                    <input type="range" id="initX" min="-1" max="1" step="0.01" value="0">
                </div>
                <div class="input-group">
                    <label for="initY">Y: <span id="initYValue">0.0</span></label>
                    <input type="range" id="initY" min="-1" max="1" step="0.01" value="0">
                </div>
                <div class="input-group">
                    <label for="initZ">Z: <span id="initZValue">0.0</span></label>
                    <input type="range" id="initZ" min="-1" max="1" step="0.01" value="0">
                </div>
                <div class="input-group">
                    <label for="initSide">Side: <span id="initSideValue">1</span></label>
                    <input type="range" id="initSide" min="-1" max="1" step="2" value="1">
                </div>
            </div>
            
            <div class="control-group">
                <h3>Step Vector (a, b, c)</h3>
                <div class="input-group">
                    <label for="stepA">A: <span id="stepAValue">0.618</span></label>
                    <input type="range" id="stepA" min="0.1" max="1.0" step="0.001" value="0.618">
                </div>
                <div class="input-group">
                    <label for="stepB">B: <span id="stepBValue">0.382</span></label>
                    <input type="range" id="stepB" min="0.1" max="1.0" step="0.001" value="0.382">
                </div>
                <div class="input-group">
                    <label for="stepC">C: <span id="stepCValue">0.236</span></label>
                    <input type="range" id="stepC" min="0.1" max="1.0" step="0.001" value="0.236">
                </div>
                <div class="info" style="margin-top: 10px; font-size: 12px;">
                    Default values based on Golden Ratio: φ = (1+√5)/2 ≈ 1.618
                </div>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <h3>Rotation Quaternion (for 2D projection)</h3>
                <div class="input-group">
                    <label for="rotW">W: <span id="rotWValue">1.0</span></label>
                    <input type="range" id="rotW" min="-1" max="1" step="0.01" value="1">
                </div>
                <div class="input-group">
                    <label for="rotX">X: <span id="rotXValue">0.0</span></label>
                    <input type="range" id="rotX" min="-1" max="1" step="0.01" value="0">
                </div>
                <div class="input-group">
                    <label for="rotY">Y: <span id="rotYValue">0.0</span></label>
                    <input type="range" id="rotY" min="-1" max="1" step="0.01" value="0">
                </div>
                <div class="input-group">
                    <label for="rotZ">Z: <span id="rotZValue">0.0</span></label>
                    <input type="range" id="rotZ" min="-1" max="1" step="0.01" value="0">
                </div>
            </div>
            
            <div class="control-group">
                <h3>Visualization Settings</h3>
                <div class="input-group">
                    <label for="numPoints">Number of Points: <span id="numPointsValue">1000</span></label>
                    <input type="range" id="numPoints" min="100" max="5000" step="100" value="1000">
                </div>
                <div class="input-group">
                    <label for="pointSize">Point Size: <span id="pointSizeValue">2</span></label>
                    <input type="range" id="pointSize" min="1" max="10" step="0.5" value="2">
                </div>
                <div class="input-group">
                    <label for="speed">Animation Speed: <span id="speedValue">1</span></label>
                    <input type="range" id="speed" min="0.1" max="5" step="0.1" value="1">
                </div>
                <div class="input-group">
                    <label for="maxPoints">Max Points: <span id="maxPointsValue">2000</span></label>
                    <input type="range" id="maxPoints" min="4" max="5000" step="1" value="2000">
                </div>
                <div class="input-group">
                    <label for="pointsPerFrame">Points per Frame: <span id="pointsPerFrameValue">50</span></label>
                    <input type="range" id="pointsPerFrame" min="1" max="200" step="1" value="50">
                </div>
                <div class="input-group">
                    <label for="projectionMode">Projection Mode: <span id="projectionModeValue">Simple</span></label>
                    <select id="projectionMode" style="width: 100%; padding: 8px; border: none; border-radius: 5px; background: rgba(255, 255, 255, 0.9); color: #333;">
                        <option value="simple">Simple (rotate then project)</option>
                        <option value="advanced">Advanced (quaternion sphere rotation)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="sideFlipVariation">Side Flip Variation: <span id="sideFlipVariationValue">1</span></label>
                    <select id="sideFlipVariation" style="width: 100%; padding: 8px; border: none; border-radius: 5px; background: rgba(255, 255, 255, 0.9); color: #333;">
                        <option value="0">Plain Flip (no coordinate change)</option>
                        <option value="1">Variation 1 (flip smallest component)</option>
                        <option value="2">Variation 2 (flip all except largest)</option>
                    </select>
                </div>
                <div class="info" style="margin-top: 10px; font-size: 12px;">
                    <strong>Evolution Modes:</strong><br>
                    • Snake: 4 points, 1 per frame (watch calculation unfold)<br>
                    • Cloud: 1000+ points, 50+ per frame (see pattern mutate)<br><br>
                    <strong>Projection Modes:</strong><br>
                    • Simple: Rotate 3D point, take x,y coordinates<br>
                    • Advanced: Use quaternion to rotate sphere point, then project<br><br>
                    <strong>Side Flip Variations:</strong><br>
                    • Plain: Just flip side, no coordinate change<br>
                    • Var 1: Flip smallest component (weak attractor)<br>
                    • Var 2: Flip all except largest (elongated patterns)
                </div>
            </div>
        </div>
        
        <div class="buttons">
            <button id="randomizeBtn" class="randomize-btn">Randomize Parameters</button>
            <button id="goldenRatioBtn" style="background: linear-gradient(45deg, #f39c12, #e67e22);">Set Golden Ratio</button>
            <button id="snakeModeBtn" style="background: linear-gradient(45deg, #27ae60, #2ecc71);">Snake Mode (4/1)</button>
            <button id="cloudModeBtn" style="background: linear-gradient(45deg, #3498db, #2980b9);">Cloud Mode (1000/100)</button>
            <button id="clearBtn" class="clear-btn">Clear Points</button>
            <button id="generateBtn">Generate Points</button>
            <button id="animateBtn">Start Animation</button>
            <button id="debugBtn" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">Debug Info</button>
        </div>
        
        <div class="canvas-container">
            <canvas id="canvas" width="800" height="600"></canvas>
            <div class="info">
                <strong>Instructions:</strong> Adjust the parameters above and click "Generate Points" to visualize the quaternion attractor. 
                The system uses stereographic projection from 4D to 3D with side flipping when points leave the unit ball.
            </div>
        </div>
    </div>
    
    <script src="quaternion_attractor.js"></script>
</body>
</html>
